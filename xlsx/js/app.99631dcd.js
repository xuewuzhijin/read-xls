(function(e){function t(t){for(var n,r,i=t[0],l=t[1],c=t[2],u=0,h=[];u<i.length;u++)r=i[u],a[r]&&h.push(a[r][0]),a[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);d&&d(t);while(h.length)h.shift()();return s.push.apply(s,c||[]),o()}function o(){for(var e,t=0;t<s.length;t++){for(var o=s[t],n=!0,i=1;i<o.length;i++){var l=o[i];0!==a[l]&&(n=!1)}n&&(s.splice(t--,1),e=r(r.s=o[0]))}return e}var n={},a={app:0},s=[];function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=n,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/xlsx/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var d=l;s.push([1,"chunk-vendors"]),o()})({0:function(e,t){},1:function(e,t,o){e.exports=o("56d7")},2:function(e,t){},3:function(e,t){},"56d7":function(e,t,o){"use strict";o.r(t);var n=o("117e"),a=o("6be2"),s=o("d3b2"),r=o("01f8"),i=(o("cadf"),o("551c"),o("f751"),o("097d"),o("2b0e")),l=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("label",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[o("input",{ref:"files",attrs:{type:"file",id:"files",multiple:""},on:{change:function(t){return e.handleFilesUpload()}}})]),o("div",{staticClass:"component"},[o("div",{staticClass:"tools"},[o("div",{staticClass:"upload"},[o("Button",{attrs:{icon:"md-cloud-upload",type:"dashed"},on:{click:e.addFiles}},[e._v("点击上传")])],1),o("div",{staticClass:"transform"},[o("Button",{attrs:{icon:"md-cog",type:"primary"},on:{click:e.transform}},[e._v("开始转换")])],1)]),o("div",{staticClass:"views"},[o("Button",{directives:[{name:"show",rawName:"v-show",value:e.data.length,expression:"data.length"}],attrs:{icon:"md-eye",type:"primary"},on:{click:e.showTable}},[e._v("渲染表格")])],1),o("Button",{directives:[{name:"show",rawName:"v-show",value:e.showDownload,expression:"showDownload"}],attrs:{icon:"md-cloud-download",type:"primary"},on:{click:e.download}},[e._v("点击下载")])],1),o("Modal",{attrs:{title:"提示",width:"300"},on:{"on-ok":e.transform},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[o("p",[e._v("表格上传成功，是否开始转换？")])]),o("Table",{directives:[{name:"show",rawName:"v-show",value:e.view.data.length,expression:"view.data.length"}],ref:"table",attrs:{stripe:"",height:"500",loading:e.loading,columns:e.view.columns,data:e.view.data}})],1)},c=[],d=(o("c5f6"),o("3b2b"),o("28a5"),o("a481"),o("34ef"),o("cf8e")),u=o("1146"),h=o.n(u),f={name:"app",components:{Table:d["a"]},data:function(){return{loading:!0,showDownload:!1,modal:!1,view:{columns:[],data:[]},files:[],table:[{title:"盘源编码",key:"houseCoding",sortable:!0},{title:"楼盘名称",key:"houseName",sortable:!0},{title:"楼栋单元",key:"buildUnit"},{title:"房号",key:"room"},{title:"业主姓名",key:"name"},{title:"业主电话",key:"phone"},{title:"业主电话1",key:"phone1"},{title:"面积",key:"acreage",sortable:!0},{title:"户型",key:"houseType"},{title:"租价",key:"rentPrice",sortable:!0},{title:"租接盘人",key:"rentBelong"},{title:"售价",key:"salePrice",sortable:!0},{title:"售接盘人",key:"saleBelong"},{title:"登记人",key:"register"},{title:"备注",key:"rentComments"}],data:[],json:[]}},methods:{addFiles:function(){this.$refs.files.click()},handleFilesUpload:function(){for(var e=this.$refs.files.files,t=0;t<e.length;t++)this.files.push(e[t]);var o=e[0],n=new FileReader;n.onload=function(e){var t=e.target.result;t=new Uint8Array(t);var o=h.a.read(t,{type:"array"}),n=o.SheetNames[0],a=o.Sheets[n],s=h.a.utils.sheet_to_json(a,{header:1});s.shift(),this.$set(this,"json",s),this.modal=!0}.bind(this),n.readAsArrayBuffer(o)},removeFile:function(e){this.files.splice(e,1)},transform:function(){for(var e=/(^[\s|,|，|。|、|\.|\||\/]{1,}|[\s|,|，|。|、|\.|\||\/]{1,}$)/g,t=/(\-|,|，|。|~|\s|\/|、|\.|\|){1,}/g,o="00000",n=this.getRandomWord(),a=0;a<this.json.length;a++){var s={houseCoding:"",houseName:"",buildUnit:"",room:"",name:"",phone:"",phone1:"",acreage:"",houseType:"",rentPrice:"",rentBelong:"",salePrice:"",saleBelong:"",register:"",rentComments:""},r=this.json[a][12].replace(e,"");r=r.replace(t,"/").split("/");var i=new RegExp("\\d{"+String(a+1).length+","+String(a+1).length+"}$");s.houseCoding=n+o.replace(i,a+1),s.houseName=this.json[a][0],s.buildUnit=this.json[a][1],s.room=this.json[a][2]+this.json[a][3],s.name=this.json[a][11],s.phone=r.shift(),s.phone1=r.join("-"),s.acreage=Number(this.json[a][4]),s.houseType=Number(this.json[a][5])+"房"+Number(this.json[a][6])+"厅",this.data.push(s)}this.$Message.success("转换完成，选择需要显示的数据")},showTable:function(){var e=this;this.$Message.success("若文件内容过多会导致渲染数据延迟，请耐心等待"),this.loading=!0,setTimeout(function(){e.$set(e.view,"columns",e.table),e.$set(e.view,"data",e.data),e.loading=!1,e.$Message.success("表格渲染成功，可以点击下载按钮下载该表格"),e.showDownload=!0})},download:function(){this.$Message.info({content:"正在下载中，若浏览器提示下载失败则是因为文件过大表格绘制异常导致提示网络错误，此时你可以选择复制表格粘贴到Excel中",duration:30,closable:!0});var e="data:application/vnd.ms-excel;base64,",t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Sheet</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>{table}</body></html>',o=this.$refs.table.$refs.header.children[0].children[1].outerHTML,n=this.$refs.table.$refs.tbody.$el.outerHTML.replace(/(<colgroup>.+<\/colgroup>)/,o),a=t.replace(/({table})/,n),s=document.createElement("a");s.href=e+window.btoa(unescape(encodeURIComponent(a))),s.download="唧唧复唧唧，木兰当户织.xls",s.click()},getRandomWord:function(){for(var e=[],t=0;t<2;t++){var o=Math.ceil(25*Math.random());e.push(String.fromCharCode(65+o))}return e.join("")}}},p=f,m=(o("7faf"),o("2877")),v=Object(m["a"])(p,l,c,!1,null,null,null),b=v.exports;o("dcad");i["a"].component("Button",r["a"]),i["a"].component("Icon",s["a"]),i["a"].component("Modal",a["a"]),i["a"].prototype.$Message=n["a"],i["a"].config.productionTip=!1,new i["a"]({render:function(e){return e(b)}}).$mount("#app")},"7faf":function(e,t,o){"use strict";var n=o("8fba"),a=o.n(n);a.a},"8fba":function(e,t,o){}});
//# sourceMappingURL=app.99631dcd.js.map